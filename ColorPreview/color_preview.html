<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aubliq Box Color Preview System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            min-height: 800px;
        }

        .preview-section {
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }

        .controls-section {
            padding: 30px;
            background: white;
            border-left: 1px solid #dee2e6;
            overflow-y: auto;
        }

        /* Base Selector */
        .base-selector {
            margin-bottom: 30px;
        }

        .base-selector h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1.2rem;
        }

        .base-buttons {
            display: flex;
            gap: 10px;
        }

        .base-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .base-btn.active {
            background: #3498db;
            color: white;
            border-color: #3498db;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .base-btn:hover:not(.active) {
            border-color: #3498db;
            transform: translateY(-1px);
        }

        /* Color Palettes */
        .color-palette {
            margin-bottom: 30px;
        }

        .color-palette h3 {
            margin-bottom: 15px;
            color: #2c3e50;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .material-icon {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }

        .leather-icon {
            background: #8b4513;
        }

        .suede-icon {
            background: #9b59b6;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 5px;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            background: #f8f9fa;
        }

        .color-swatch {
            width: 35px;
            height: 35px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            position: relative;
        }

        .color-swatch:hover {
            transform: scale(1.1);
            border-color: #2c3e50;
            z-index: 10;
        }

        .color-swatch.selected {
            border-color: #e74c3c;
            border-width: 3px;
            transform: scale(1.15);
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
        }

        .color-swatch::after {
            content: attr(data-number);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            color: #666;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .color-swatch:hover::after {
            opacity: 1;
        }

        /* Selected Colors Display */
        .selected-colors {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .selected-colors h4 {
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .selected-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .selected-color-display {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            border: 2px solid #bdc3c7;
        }

        .selected-details {
            flex: 1;
        }

        .selected-details strong {
            display: block;
            color: #2c3e50;
        }

        .selected-details small {
            color: #7f8c8d;
        }

        /* Box Mockup */
        .box-mockup {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 20px auto;
        }

        .box-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(-10deg) rotateY(15deg);
            transition: all 0.5s ease;
        }

        .box-face {
            position: absolute;
            border: 1px solid rgba(0,0,0,0.1);
        }

        /* Box faces */
        .box-front {
            width: 300px;
            height: 200px;
            background: var(--base-color, #f0f0f0);
            transform: translateZ(150px);
            border-radius: 10px;
        }

        .box-right {
            width: 300px;
            height: 200px;
            background: var(--base-color-dark, #e0e0e0);
            transform: rotateY(90deg) translateZ(150px);
            border-radius: 10px;
        }

        .box-top {
            width: 300px;
            height: 300px;
            background: var(--base-color-light, #f8f8f8);
            transform: rotateX(90deg) translateZ(100px);
            border-radius: 10px;
        }

        /* Material panels on the box */
        .leather-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 120px;
            height: 80px;
            background: var(--leather-color, #8b4513);
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .suede-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 120px;
            height: 80px;
            background: var(--suede-color, #9b59b6);
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn {
            background: #27ae60;
            color: white;
        }

        .export-btn:hover {
            background: #2ecc71;
            transform: translateY(-2px);
        }

        .reset-btn {
            background: #e74c3c;
            color: white;
        }

        .reset-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        /* Loading and Status */
        .status-message {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
            font-style: italic;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .controls-section {
                border-left: none;
                border-top: 1px solid #dee2e6;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎨 Aubliq Box Color Preview</h1>
            <p>Interactive Color Combination System for Leather & Suede Materials</p>
        </div>

        <div class="main-content">
            <div class="preview-section">
                <div class="box-mockup">
                    <div class="box-3d">
                        <div class="box-face box-front">
                            <div class="leather-panel"></div>
                            <div class="suede-panel"></div>
                        </div>
                        <div class="box-face box-right">
                            <div class="leather-panel"></div>
                            <div class="suede-panel"></div>
                        </div>
                        <div class="box-face box-top">
                            <div class="leather-panel"></div>
                            <div class="suede-panel"></div>
                        </div>
                    </div>
                </div>

                <div class="selected-colors">
                    <h4>Current Selection</h4>
                    <div class="selected-info">
                        <div class="selected-color-display" id="selected-leather-display"></div>
                        <div class="selected-details">
                            <strong id="selected-leather-name">Leather: Not Selected</strong>
                            <small id="selected-leather-hex">#8b4513</small>
                        </div>
                    </div>
                    <div class="selected-info">
                        <div class="selected-color-display" id="selected-suede-display"></div>
                        <div class="selected-details">
                            <strong id="selected-suede-name">Suede: Not Selected</strong>
                            <small id="selected-suede-hex">#9b59b6</small>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="action-btn export-btn" onclick="exportCombination()">💾 Save Combination</button>
                    <button class="action-btn reset-btn" onclick="resetSelection()">🔄 Reset Colors</button>
                </div>
            </div>

            <div class="controls-section">
                <div class="base-selector">
                    <h3>📦 Box Base Color</h3>
                    <div class="base-buttons">
                        <div class="base-btn active" data-base="light" onclick="selectBase('light')">
                            ☀️ Light Base
                        </div>
                        <div class="base-btn" data-base="dark" onclick="selectBase('dark')">
                            🌙 Dark Base
                        </div>
                    </div>
                </div>

                <div class="color-palette">
                    <h3>
                        <div class="material-icon leather-icon"></div>
                        Leather Colors (85)
                    </h3>
                    <div class="color-grid" id="leather-colors">
                        <div class="status-message">Loading leather colors...</div>
                    </div>
                </div>

                <div class="color-palette">
                    <h3>
                        <div class="material-icon suede-icon"></div>
                        Suede Colors (480)
                    </h3>
                    <div class="color-grid" id="suede-colors">
                        <div class="status-message">Loading suede colors...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let appState = {
            baseColor: 'light',
            selectedLeather: null,
            selectedSuede: null,
            leatherColors: [],
            suedeColors: []
        };

        // Initialize the application
        async function initApp() {
            try {
                await loadColorData();
                renderColorPalettes();
                updatePreview();
            } catch (error) {
                console.error('Failed to initialize app:', error);
                showError('Failed to load color data. Please ensure color files are available.');
            }
        }

        // Load color data from JSON files
        async function loadColorData() {
            try {
                // Load leather colors
                const leatherResponse = await fetch('../Leather/leather_colors.json');
                const leatherData = await leatherResponse.json();
                appState.leatherColors = leatherData.leather_colors || [];

                // Load suede colors  
                const suedeResponse = await fetch('../Suede/extracted_colors_FINAL.json');
                const suedeData = await suedeResponse.json();
                
                // Flatten suede colors from all images
                appState.suedeColors = [];
                Object.values(suedeData).forEach(imageColors => {
                    appState.suedeColors.push(...imageColors);
                });

                console.log(`Loaded ${appState.leatherColors.length} leather colors and ${appState.suedeColors.length} suede colors`);
            } catch (error) {
                console.error('Error loading color data:', error);
                // Fallback: create sample data
                createSampleData();
            }
        }

        // Create sample data if files can't be loaded
        function createSampleData() {
            console.log('Using sample color data');
            
            // Sample leather colors
            appState.leatherColors = Array.from({length: 20}, (_, i) => ({
                color_number: String(i + 1).padStart(3, '0'),
                hex: `hsl(${i * 18}, 60%, 45%)`,
                rgb: [120, 80, 60],
                name: `Leather ${i + 1}`
            }));

            // Sample suede colors
            appState.suedeColors = Array.from({length: 40}, (_, i) => ({
                color_number: String(i + 1).padStart(3, '0'),
                hex: `hsl(${i * 9}, 70%, 55%)`,
                rgb: [150, 100, 80],
                name: `Suede ${i + 1}`
            }));
        }

        // Render color palettes
        function renderColorPalettes() {
            renderLeatherColors();
            renderSuedeColors();
        }

        function renderLeatherColors() {
            const container = document.getElementById('leather-colors');
            container.innerHTML = '';

            appState.leatherColors.forEach(color => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color.hex;
                swatch.dataset.number = color.color_number;
                swatch.title = `${color.color_number}: ${color.hex}`;
                swatch.onclick = () => selectLeatherColor(color);
                container.appendChild(swatch);
            });
        }

        function renderSuedeColors() {
            const container = document.getElementById('suede-colors');
            container.innerHTML = '';

            appState.suedeColors.forEach(color => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color.hex;
                swatch.dataset.number = color.color_number;
                swatch.title = `${color.color_number}: ${color.hex}`;
                swatch.onclick = () => selectSuedeColor(color);
                container.appendChild(swatch);
            });
        }

        // Color selection functions
        function selectLeatherColor(color) {
            // Remove previous selection
            document.querySelectorAll('#leather-colors .color-swatch').forEach(s => s.classList.remove('selected'));
            
            // Add selection to clicked swatch
            event.target.classList.add('selected');
            
            appState.selectedLeather = color;
            updateSelectedDisplay();
            updatePreview();
        }

        function selectSuedeColor(color) {
            // Remove previous selection
            document.querySelectorAll('#suede-colors .color-swatch').forEach(s => s.classList.remove('selected'));
            
            // Add selection to clicked swatch
            event.target.classList.add('selected');
            
            appState.selectedSuede = color;
            updateSelectedDisplay();
            updatePreview();
        }

        function selectBase(baseType) {
            // Update button states
            document.querySelectorAll('.base-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-base="${baseType}"]`).classList.add('active');
            
            appState.baseColor = baseType;
            updatePreview();
        }

        // Update the selected colors display
        function updateSelectedDisplay() {
            if (appState.selectedLeather) {
                const display = document.getElementById('selected-leather-display');
                const name = document.getElementById('selected-leather-name');
                const hex = document.getElementById('selected-leather-hex');
                
                display.style.backgroundColor = appState.selectedLeather.hex;
                name.textContent = `Leather: ${appState.selectedLeather.color_number}`;
                hex.textContent = appState.selectedLeather.hex;
            }

            if (appState.selectedSuede) {
                const display = document.getElementById('selected-suede-display');
                const name = document.getElementById('selected-suede-name');
                const hex = document.getElementById('selected-suede-hex');
                
                display.style.backgroundColor = appState.selectedSuede.hex;
                name.textContent = `Suede: ${appState.selectedSuede.color_number}`;
                hex.textContent = appState.selectedSuede.hex;
            }
        }

        // Update the 3D preview
        function updatePreview() {
            const root = document.documentElement;
            
            // Set base colors
            if (appState.baseColor === 'light') {
                root.style.setProperty('--base-color', '#f5f5f5');
                root.style.setProperty('--base-color-dark', '#e8e8e8');
                root.style.setProperty('--base-color-light', '#fafafa');
            } else {
                root.style.setProperty('--base-color', '#2c3e50');
                root.style.setProperty('--base-color-dark', '#1a252f');
                root.style.setProperty('--base-color-light', '#34495e');
            }

            // Set material colors
            if (appState.selectedLeather) {
                root.style.setProperty('--leather-color', appState.selectedLeather.hex);
            }

            if (appState.selectedSuede) {
                root.style.setProperty('--suede-color', appState.selectedSuede.hex);
            }
        }

        // Export current combination
        function exportCombination() {
            const combination = {
                base: appState.baseColor,
                leather: appState.selectedLeather,
                suede: appState.selectedSuede,
                timestamp: new Date().toISOString()
            };

            const dataStr = JSON.stringify(combination, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `color-combination-${Date.now()}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
        }

        // Reset selection
        function resetSelection() {
            appState.selectedLeather = null;
            appState.selectedSuede = null;
            
            document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
            
            document.getElementById('selected-leather-name').textContent = 'Leather: Not Selected';
            document.getElementById('selected-leather-hex').textContent = '#8b4513';
            document.getElementById('selected-leather-display').style.backgroundColor = '#8b4513';
            
            document.getElementById('selected-suede-name').textContent = 'Suede: Not Selected';
            document.getElementById('selected-suede-hex').textContent = '#9b59b6';
            document.getElementById('selected-suede-display').style.backgroundColor = '#9b59b6';
            
            updatePreview();
        }

        function showError(message) {
            const container = document.querySelector('.preview-section');
            container.innerHTML = `<div class="status-message" style="color: #e74c3c;">${message}</div>`;
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
